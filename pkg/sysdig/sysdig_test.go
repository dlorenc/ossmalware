package sysdig

import (
	"fmt"
	"strings"
	"testing"
)

func TestCreateMetadataFilter(t *testing.T) {
	got := createMetadataFilter()
	defaultFilter := strings.Join(metadataFilters, " or ")
	if got != defaultFilter {
		t.Fatalf("incorrect default filter received.\n expected: %s\n got: %s", defaultFilter, got)
	}

	ignoreList := []string{"evt.type=ignore", "evt.type=also_ignore"}
	ignoreFilter := strings.Join(ignoreList, " and ")
	expected := fmt.Sprintf("(%s) and %s", defaultFilter, ignoreFilter)
	got = createMetadataFilter(ignoreList...)
	if got != expected {
		t.Fatalf("incorrect default filter received.\n expected: %s\n got: %s", expected, got)
	}
}
