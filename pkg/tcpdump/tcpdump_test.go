package tcpdump

import (
	"reflect"
	"testing"
)

func TestGenerateCmd(t *testing.T) {
	ignoreHosts := []string{"example.com", "foo.bar"}
	pcapPath := "output.pcap"
	expected := []string{"tcpdump", "-w", "/opt/output.pcap", "not host example.com and not host foo.bar"}
	got := generateCmd(pcapPath, ignoreHosts...)
	if !reflect.DeepEqual(got, expected) {
		t.Fatalf("incorrect command generated.\nexptected: %#v\ngot %#v", expected, got)
	}
}
